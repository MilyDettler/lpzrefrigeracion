<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Orden de Trabajo</title>
    <link href="estilos/style.css" rel="stylesheet" type="text/css"/>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="Validaciones/app.js" type="text/javascript"></script>
    <script src="https://cdn.jsdelivr.net/npm/signature_pad@4.1.7/dist/signature_pad.umd.min.js"></script>
    <script src="Validaciones/agregar.js" type="text/javascript"></script>
    <script>
        // Función para generar el número de orden al cargar la página
        function generarNumeroOrden() {
            const numeroOrden = 'ORD-' + Math.floor(Math.random() * 1000000);
            document.getElementById('numeroOrden').value = numeroOrden;
        }

        window.onload = generarNumeroOrden;
    </script>
</head>
<body>
    <div class="container">
        <!-- Logo y encabezado -->
        <div class="text-center">
            <img src="imagen/LOPEZ logo.svg" alt="logo.1" class="logo"/>
        </div>
        <div class="dueño"><br><br>
            <h3>LÓPEZ MARIANO</h3>
            <p class="mb-1">Técnico Mecánico y Frigorista</p>
        </div>
        <div class="datos">
            <p><img src="imagen/tel.png" alt="tel" class="tel"/> (0343) 155244293</p>
            <p><img src="imagen/ubi.png" alt="ubi" class="ubi"/> 3100 Paraná, Entre Ríos</p>
            <p><img src="imagen/mail.png" alt="mail" class="mail"/> lopez.mariano@live.com</p>
            <p><img src="imagen/nav.png" alt="nav" class="nav"/> LPZ Refrigeración</p>
        </div>

        <h5 class="text-center my-3">ORDEN DE TRABAJO</h5>
        <form method="post" action="Formulario.php" onsubmit="return verificarNumeroOrden()">
            <label for="numeroOrden">Número de Orden</label>
            <input type="text" id="numeroOrden" name="numeroOrden" readonly="">
        </form>

        <div class="contenedor_formulario">
            <form method="post" action="Formulario.php" enctype="multipart/form-data" id="form">
                <input type="hidden" name="accion" value="submit"/>
                
                <div class="form-group">
                    <label for="date">Seleccione una fecha</label>
                    <input type="date" class="form-control" name="date" id="date">
                </div>

                <div class="form-group">
                    <label for="servicioSolicitado">Servicio Solicitado</label>
                    <input type="text" class="form-control" name="servicioSolicitado" id="servicioSolicitado" placeholder="Servicio Solicitado">
                </div>

                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="razonSocial">Razón Social</label>
                        <input type="text" class="form-control" name="razonSocial" id="razonSocial" placeholder="Razón Social">
                    </div>
                    <div class="form-group col-md-6">
                        <label for="solicitante">Solicitante</label>
                        <input type="text" class="form-control" name="solicitante" id="solicitante" placeholder="Solicitante">
                    </div>
                </div>

                <!-- Select de tiendas -->
                <div class="form-group col-md-6">
                    <label for="locacion">Nº de tienda</label>
                    <select id="locacion" name="tienda_id" required>
                        <?php foreach ($tiendas as $tienda): ?>
                            <option value="<?= $tienda['id'] ?>"><?= $tienda['tienda'] ?></option>
                        <?php endforeach; ?>
                    </select>
                    <a href="../ABM/Tienda/index.php" class="btn btn-link">Agregar</a>
                </div>

                <!-- Select de tickets -->
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="ticket">Nº de Ticket</label>
                        <select id="ticket" name="ticket_id" required>
                            <?php foreach ($tickets as $ticket): ?>
                                <option value="<?= $ticket['id'] ?>"><?= $ticket['ticket'] ?></option>
                            <?php endforeach; ?>
                        </select>
                        <a href="../ABM/Ticket/index.php" class="btn btn-link">Agregar</a>
                    </div>
                </div>

                <!-- Select de direcciones -->
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="direccion">Dirección</label>
                        <select id="direccion" name="direccion_id" required>
                            <?php foreach ($direcciones as $direccion): ?>
                                <option value="<?= $direccion['id'] ?>"><?= $direccion['direccion'] ?></option>
                            <?php endforeach; ?>
                        </select>
                        <a href="../ABM/Direccion/index.php" class="btn btn-link">Agregar</a>
                    </div>
                </div>

                <!-- Select de provincias -->
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="provincia">Provincia</label>
                        <select id="provincia" name="provincia_id" required>
                            <?php foreach ($provincias as $provincia): ?>
                                <option value="<?= $provincia['id'] ?>"><?= $provincia['provincia'] ?></option>
                            <?php endforeach; ?>
                        </select>
                        <a href="../ABM/Provincia/index.php" class="btn btn-link">Agregar</a>
                    </div>
                </div>

                <!-- Select de localidades -->
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="localidad">Localidad</label>
                        <select id="localidad" name="localidad_id" required>
                            <?php foreach ($localidades as $localidad): ?>
                                <option value="<?= $localidad['id'] ?>"><?= $localidad['localidad'] ?></option>
                            <?php endforeach; ?>
                        </select>
                        <a href="../ABM/Localidad/index.php" class="btn btn-link">Agregar</a>
                    </div>
                </div>

                <!-- Otros campos del formulario -->
                <div class="form-group">
                    <label for="inconveniente">Inconveniente Detectado</label>
                    <input type="text" class="form-control" name="inconveniente" id="inconveniente" placeholder="Inconveniente Detectado">
                </div>

                <div class="form-group">
                    <label for="tareas">Tareas Desarrolladas</label>
                    <textarea id="tareas" name="tareas" rows="5" class="form-control" placeholder="Tareas desarrolladas"></textarea>
                </div>
                <div class="form-group">
                    <label for="repuestos">Repuestos Utilizados</label>
                    <textarea id="repuestos" name="repuestos" rows="5" cols="40" placeholder="Repuestos Utilizados"></textarea>
                </div>

                <div class="form-group">
                    <label for="observaciones">Observaciones</label>
                    <textarea id="observaciones" name="observaciones" rows="5" cols="40" placeholder="Observaciones"></textarea>
                    <div class="custom-control custom-radio">
                        <input type="radio" id="resuelto" name="estado" class="custom-control-input" value="Resuelto">
                        <label class="custom-control-label" for="resuelto">Resuelto</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input type="radio" id="pendiente" name="estado" class="custom-control-input" value="Pendiente">
                        <label class="custom-control-label" for="pendiente">Pendiente</label>
                    </div>
                    <div class="custom-control custom-radio">
                        <input type="radio" id="presupuestar" name="estado" class="custom-control-input" value="A Presupuestar">
                        <label class="custom-control-label" for="presupuestar">A Presupuestar</label>
                    </div>
                </div>

                <div class="form-group">
                    <label for="horaEntrada">Hora de Entrada</label>
                    <input type="time" class="form-control" name="horaEntrada" id="horaEntrada">
                </div>
                <div class="form-group">
                    <label for="horaSalida">Hora de Salida</label>
                    <input type="time" class="form-control" name="horaSalida" id="horaSalida">
                </div>

                <div class="form-group">
                    <label for="horaTotal">Cantidad de Horas</label>
                    <input type="number" class="form-control" name="horaTotal" id="horaTotal">
                </div>
                <div class="form-group">
                    <label for="kilometros">Cantidad de KM</label>
                    <input type="number" class="form-control" name="kilometros" id="kilometros">
                </div>
                <div class="form-group">
                    <label for="operarios">Cantidad de Operarios</label>
                    <input type="number" class="form-control" name="operarios" id="operarios">
                </div>

                <!-- Firma del técnico -->
                <br>
                <div class="form-group">
                    <label for="fileInput" class="custom-file-upload">Firma Técnico</label>
                    <input type="file" id="fileInput" name="firmaTecnico" accept="image/*" required>
                </div>
                <div class="form-group">
                    <p><b>Quien suscribe, en representación del cliente, recibe conforme el servicio prestado por <img src="imagen/LOPEZ logo.svg" alt="logo" class="logo"/></b></p>
                    <span class="d-block pb-2" style="font-size: 15px; color: #264653;"><b>Firma Tienda:</b></span><br>
                    <div class="signature mb-2" style="width: 50%; height: 100px;">
                        <canvas id="signature-canvas" style="border: 1px dashed black; width: 70%; height: 100px;"></canvas>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="legajo" class="legajo">Legajo</label>
                        <input type="number" class="form-control" name="aclaracion" id="aclaracion" placeholder="Legajo">
                    </div>
                </div>
                <!-- Botón enviar -->
                <br>
                <button type="submit" class="btn btn-primary" name="submit">Generar PDF</button>
            </form>
        </div>
    </div>
</body>
</html>
